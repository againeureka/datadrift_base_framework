# ddoc v1.3.6 ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸

**ë¦´ë¦¬ìŠ¤ ë‚ ì§œ**: 2025ë…„ 11ì›” 13ì¼  
**ì£¼ìš” ë³€ê²½**: MLflow í†µí•© ë° ì‹¤í—˜ ì¶”ì  ì‹œìŠ¤í…œ ê°œì„ 

---

## ğŸ‰ ì£¼ìš” ë³€ê²½ì‚¬í•­

### MLflow ê¸°ë°˜ ì‹¤í—˜ ì¶”ì  ì‹œìŠ¤í…œ

ddoc v1.3.6ì—ì„œëŠ” **MLflow ê¸°ë°˜ ì‹¤í—˜ ì¶”ì  ì‹œìŠ¤í…œ**ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ DVC ExperimentsëŠ” Git ì €ì¥ì†Œë¥¼ í•„ìˆ˜ë¡œ ìš”êµ¬í–ˆì§€ë§Œ, MLflowë¥¼ ì‚¬ìš©í•˜ë©´ **Git ì—†ì´ë„ ì‹¤í—˜ì„ ì¶”ì **í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### í•µì‹¬ ê¸°ëŠ¥

- âœ… **Git ë¶ˆí•„ìš”**: MLflow ìì²´ ì¶”ì  ì‹œìŠ¤í…œìœ¼ë¡œ Git ì €ì¥ì†Œ ì—†ì´ ì‹¤í—˜ ê°€ëŠ¥
- âœ… **Ultralytics ë„¤ì´í‹°ë¸Œ í†µí•©**: YOLO í•™ìŠµ ì‹œ ìë™ MLflow ë¡œê¹…
- âœ… **ë°ì´í„° ë²„ì „ ê³„ë³´ ì—°ë™**: ëª¨ë“  ì‹¤í—˜ì´ ë°ì´í„°ì…‹ ë²„ì „ ê³„ë³´ ê·¸ë˜í”„ì— ìë™ ì—°ê²°
- âœ… **ê°•ë ¥í•œ UI**: MLflow UIë¥¼ í†µí•œ ì‹¤í—˜ ë¹„êµ, ë©”íŠ¸ë¦­ ì‹œê°í™”, ëª¨ë¸ ê´€ë¦¬
- âœ… **ë©€í‹° íŠ¸ë™ ì§€ì›**: DVC(Git ê¸°ë°˜)ì™€ MLflow(Git ë¶ˆí•„ìš”) ë™ì‹œ ì§€ì›

---

## ğŸ“¦ ìƒˆë¡œìš´ ê¸°ëŠ¥

### 1. MLflow ê¸°ë°˜ ì‹¤í—˜ ì‹¤í–‰ (ê¸°ë³¸ê°’)

```bash
# Git ì—†ì´ ì‹¤í—˜ ì‹¤í–‰
ddoc exp run source@v1.0 --model yolov8n.pt --epochs 10

# MLflow UIì—ì„œ ê²°ê³¼ í™•ì¸
mlflow ui
```

**ìë™ ë¡œê¹… í•­ëª©** (Ultralyticsê°€ ìë™ìœ¼ë¡œ ê¸°ë¡):
- íŒŒë¼ë¯¸í„°: epochs, batch, imgsz, device, model ë“±
- ë©”íŠ¸ë¦­: mAP50, mAP50-95, precision, recall, loss ë“±
- ì•„í‹°íŒ©íŠ¸: ëª¨ë¸ ê°€ì¤‘ì¹˜, í•™ìŠµ í”Œë¡¯, í˜¼ë™ í–‰ë ¬ ë“±

### 2. ì‹¤í—˜ ID ìë™ ìƒì„±

ì‚¬ìš©ìê°€ ì‹¤í—˜ ì´ë¦„ì„ ì§€ì •í•  í•„ìš” ì—†ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤:
- í˜•ì‹: `exp_YYYYMMDD_HHMMSS`
- ì˜ˆì‹œ: `exp_20251113_104417`

**Before (v1.3.5)**
```bash
ddoc exp run my_experiment source@v1.0 --model yolov8n.pt
```

**After (v1.3.6)**
```bash
ddoc exp run source@v1.0 --model yolov8n.pt
```

### 3. ìƒˆë¡œìš´ CLI ëª…ë ¹ì–´

#### `ddoc exp best` - ìµœê³  ì„±ëŠ¥ ì‹¤í—˜ ì°¾ê¸°

```bash
# mAP50-95 ê¸°ì¤€ ìµœê³  ì‹¤í—˜
ddoc exp best source@v1.0

# ë‹¤ë¥¸ ë©”íŠ¸ë¦­ ê¸°ì¤€
ddoc exp best source@v1.0 --metric mAP50
ddoc exp best source@v1.0 --metric precision
```

#### `ddoc exp compare --mlflow` - MLflow ì‹¤í—˜ ë¹„êµ

```bash
ddoc exp compare exp_20251113_104417 exp_20251113_105230 --mlflow
```

### 4. ë ˆê±°ì‹œ DVC ëª¨ë“œ ì§€ì›

ê¸°ì¡´ DVC Experimentsë„ ê³„ì† ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤:

```bash
# DVC ëª¨ë“œ (Git í•„ìš”)
ddoc exp run source@v1.0 --dvc

# DVC íì— ì¶”ê°€
ddoc exp run source@v1.0 --dvc --queue
```

---

## ğŸ”„ ë³€ê²½ì‚¬í•­

### CLI ëª…ë ¹ì–´

#### `ddoc exp run` ê°œì„ 

- **ì‹¤í—˜ ì´ë¦„ ì¸ì ì œê±°**: ìë™ ìƒì„±ìœ¼ë¡œ ë³€ê²½
- **`--mlflow/--no-mlflow`**: ì¶”ì  ëª¨ë“œ ì„ íƒ (ê¸°ë³¸ê°’: `--mlflow`)
- **`--dvc`**: ë ˆê±°ì‹œ DVC ëª¨ë“œ ì‚¬ìš©
- **`plugin` ì¸ì**: Argumentì—ì„œ Optionìœ¼ë¡œ ë³€ê²½ (`--plugin yolo`)

### API ë³€ê²½

#### `ExperimentService.run_experiment()`

**Before**
```python
run_experiment(exp_id, dataset, plugin, params)
```

**After**
```python
run_experiment(name, params, queue=False, dry_run=False)
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ìƒˆë¡œìš´ ì„œë¹„ìŠ¤

#### `MLflowExperimentService`

ìœ„ì¹˜: `ddoc/core/mlflow_experiment_service.py`

ì£¼ìš” ë©”ì„œë“œ:
- `run_experiment()`: MLflowë¥¼ ì‚¬ìš©í•œ ì‹¤í—˜ ì‹¤í–‰
- `get_experiments_by_dataset()`: ë°ì´í„°ì…‹ë³„ ì‹¤í—˜ ì¡°íšŒ
- `compare_experiments()`: ì‹¤í—˜ ë¹„êµ
- `get_best_experiment_for_dataset()`: ìµœê³  ì„±ëŠ¥ ì‹¤í—˜ ì°¾ê¸°

### ë°ì´í„° ë²„ì „ í†µí•©

ëª¨ë“  MLflow ì‹¤í—˜ì— ddoc ë©”íƒ€ë°ì´í„°ê°€ íƒœê·¸ë¡œ ì €ì¥ë©ë‹ˆë‹¤:

```python
mlflow.set_tags({
    "ddoc.dataset_name": "source",
    "ddoc.dataset_version": "v1.0",
    "ddoc.dataset_id": "source@v1.0",
    "ddoc.experiment_id": "exp_20251113_104417",
    "ddoc.plugin": "yolo"
})
```

### íŒŒì¼ êµ¬ì¡°

```
í”„ë¡œì íŠ¸/
â”œâ”€â”€ experiments/              # ì‹¤í—˜ ê²°ê³¼
â”‚   â””â”€â”€ exp_20251113_104417/
â”‚       â”œâ”€â”€ ddoc_metadata.json
â”‚       â””â”€â”€ weights/
â””â”€â”€ mlruns/                   # MLflow ë°ì´í„° âœ¨ (ì‹ ê·œ)
    â””â”€â”€ 0/
        â””â”€â”€ <run_id>/
            â”œâ”€â”€ metrics/
            â”œâ”€â”€ params/
            â””â”€â”€ artifacts/
```

---

## ğŸ”§ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ê¸°ì¡´ ì‚¬ìš©ì (v1.3.5 ì´í•˜)

#### 1. ì—…ê·¸ë ˆì´ë“œ

```bash
cd /path/to/ddoc
git pull
pip install -e .[yolo]
```

MLflowê°€ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë©ë‹ˆë‹¤.

#### 2. ê¸°ì¡´ ì›Œí¬í”Œë¡œìš° í˜¸í™˜ì„±

ê¸°ì¡´ ëª…ë ¹ì–´ëŠ” ì—¬ì „íˆ ì‘ë™í•©ë‹ˆë‹¤:

```bash
# DVC ëª¨ë“œë¡œ ê³„ì† ì‚¬ìš© ê°€ëŠ¥
ddoc exp run source@v1.0 --dvc

# ë˜ëŠ” ìƒˆë¡œìš´ MLflow ëª¨ë“œ ì‚¬ìš©
ddoc exp run source@v1.0
```

#### 3. ëª…ë ¹ì–´ ë³€ê²½ í•„ìš”

ì‹¤í—˜ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•˜ë˜ ë¶€ë¶„ì„ ì œê±°í•˜ì„¸ìš”:

```bash
# Before
ddoc exp run my_experiment source@v1.0 --model yolov8n.pt

# After
ddoc exp run source@v1.0 --model yolov8n.pt
```

### ìƒˆë¡œìš´ ì‚¬ìš©ì

Git ì—†ì´ ë°”ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# 1. ì„¤ì¹˜
pip install -e .[yolo]

# 2. ë°ì´í„°ì…‹ ë“±ë¡ (Git ë¶ˆí•„ìš”)
ddoc dataset add source ./datasets/source

# 3. ì‹¤í—˜ ì‹¤í–‰
ddoc exp run source@v1.0 --epochs 10

# 4. MLflow UI ì‹¤í–‰
mlflow ui
```

---

## ğŸ“Š ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ ì›Œí¬í”Œë¡œìš°

```bash
# 1. ë°ì´í„°ì…‹ ì¤€ë¹„
ddoc dataset add source ./datasets/source
ddoc dataset add target ./datasets/target

# 2. ì—¬ëŸ¬ ì‹¤í—˜ ì‹¤í–‰
ddoc exp run source@v1.0 --model yolov8n.pt --epochs 10
ddoc exp run source@v1.0 --model yolov8s.pt --epochs 20
ddoc exp run source@v1.0 --model yolov8m.pt --epochs 30

# 3. MLflow UIì—ì„œ ê²°ê³¼ í™•ì¸
mlflow ui
# â†’ http://localhost:5000

# 4. ìµœê³  ì‹¤í—˜ ì°¾ê¸°
ddoc exp best source@v1.0

# 5. ê³„ë³´ í™•ì¸
ddoc lineage show source@v1.0
```

### MLflow UI ê¸°ëŠ¥

- ğŸ“Š ì‹¤í—˜ ëª©ë¡ ë° í•„í„°ë§
- ğŸ“ˆ ë©”íŠ¸ë¦­ ë¹„êµ ë° ì‹œê°í™”
- ğŸ” íŒŒë¼ë¯¸í„° ì°¨ì´ ë¶„ì„
- ğŸ’¾ ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ë‹¤ìš´ë¡œë“œ
- ğŸ“ Run ìƒì„¸ ì •ë³´ ì¡°íšŒ

---

## ğŸ› ë²„ê·¸ ìˆ˜ì •

### `ExperimentService.run_experiment()` TypeError ìˆ˜ì •

**ë¬¸ì œ**: CLIì—ì„œ ì „ë‹¬í•˜ëŠ” íŒŒë¼ë¯¸í„°ì™€ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ ë¶ˆì¼ì¹˜

**Before**
```python
# CLIì—ì„œ í˜¸ì¶œ
run_experiment(name=name, params=train_params, queue=True)

# ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜
def run_experiment(self, exp_id, dataset, plugin, params):
```

**After**
```python
# CLIì™€ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ ì¼ì¹˜
def run_experiment(self, name, params, queue=False, dry_run=False):
```

---

## ğŸ“ˆ ì„±ëŠ¥ ë° í˜¸í™˜ì„±

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

- **Python**: 3.8+
- **MLflow**: 2.0.0+
- **Ultralytics**: 8.0.0+ (Python 3.10+) ë˜ëŠ” 7.0.0+ (Python < 3.10)
- **Git**: ì„ íƒ ì‚¬í•­ (MLflow ëª¨ë“œì—ì„œëŠ” ë¶ˆí•„ìš”)

### DVC vs MLflow ë¹„êµ

| ê¸°ëŠ¥ | DVC Experiments | MLflow |
|------|----------------|--------|
| Git í•„ìš” | âœ… í•„ìˆ˜ | âŒ ë¶ˆí•„ìš” |
| ì›¹ UI | âŒ ì—†ìŒ | âœ… ê°•ë ¥í•¨ |
| ìë™ ë¡œê¹… | âŒ ìˆ˜ë™ | âœ… ìë™ |
| ëª¨ë¸ ê´€ë¦¬ | âš ï¸ ì œí•œì  | âœ… Model Registry |
| í•™ìŠµ ê³¡ì„  | ë†’ìŒ | ë‚®ìŒ |
| ì‚¬ìš© ìƒí™© | Git ì›Œí¬í”Œë¡œìš° | ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ |

---

## ğŸ”œ í–¥í›„ ê³„íš

### Phase 1: MLflow ê³ ë„í™”
- [ ] MLflow Model Registry í†µí•©
- [ ] ëª¨ë¸ ë²„ì €ë‹ ë° ìŠ¤í…Œì´ì§•
- [ ] Production ë°°í¬ ì›Œí¬í”Œë¡œìš°

### Phase 2: ë©€í‹° í”ŒëŸ¬ê·¸ì¸ ì§€ì›
- [ ] Vision í”ŒëŸ¬ê·¸ì¸ MLflow í†µí•©
- [ ] NLP í”ŒëŸ¬ê·¸ì¸ MLflow í†µí•©
- [ ] ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ ë¡œê¹…

### Phase 3: í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ
- [ ] DVCì™€ MLflow ë™ì‹œ ì‚¬ìš©
- [ ] Git ê¸°ë°˜ ì½”ë“œ ë²„ì „ + MLflow ì‹¤í—˜ ì¶”ì 
- [ ] í†µí•© ëŒ€ì‹œë³´ë“œ

### Phase 4: ìë™í™”
- [ ] í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ (MLflow + Optuna)
- [ ] AutoML íŒŒì´í”„ë¼ì¸
- [ ] ì‹¤í—˜ ìŠ¤ì¼€ì¤„ë§

---

## ğŸ” ë¬¸ì œ í•´ê²°

### MLflowê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ

```bash
pip install mlflow>=2.0.0
```

### ì‹¤í—˜ì´ MLflowì— í‘œì‹œë˜ì§€ ì•ŠìŒ

1. MLflow UI ìƒˆë¡œê³ ì¹¨
2. `mlruns/` ë””ë ‰í† ë¦¬ í™•ì¸:
   ```bash
   ls -la mlruns/
   ```
3. MLFLOW_TRACKING_URI í™•ì¸:
   ```bash
   echo $MLFLOW_TRACKING_URI
   ```

### Ultralytics MLflow í†µí•© ë¹„í™œì„±í™”ë¨

```python
from ultralytics import settings
settings.update({"mlflow": True})
```

### MLflow UIê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

```bash
# í¬íŠ¸ ë³€ê²½
mlflow ui --port 5001

# ì›ê²© ì ‘ì† í—ˆìš©
mlflow ui --host 0.0.0.0
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [MLflow ê³µì‹ ë¬¸ì„œ](https://mlflow.org/docs/latest/index.html)
- [Ultralytics MLflow í†µí•©](https://docs.ultralytics.com/integrations/mlflow/)
- [MLflow Tracking API](https://mlflow.org/docs/latest/tracking.html)
- [ddoc ê°œë°œ ë¬¸ì„œ](../DEVELOPMENT.md)

---

## ğŸ‘¥ ê¸°ì—¬ì

- JPark (feynmanc@naver.com)

---

## ğŸ“ ë³€ê²½ ì´ë ¥

### v1.3.6 (2025-11-13)
- MLflow ê¸°ë°˜ ì‹¤í—˜ ì¶”ì  ì‹œìŠ¤í…œ ì¶”ê°€
- ì‹¤í—˜ ID ìë™ ìƒì„±
- `ddoc exp best` ëª…ë ¹ì–´ ì¶”ê°€
- `ddoc exp run` ë©€í‹° íŠ¸ë™ ì§€ì› (MLflow/DVC)
- Ultralytics ë„¤ì´í‹°ë¸Œ MLflow í†µí•©
- ë°ì´í„° ë²„ì „ ê³„ë³´ ì—°ë™
- `ExperimentService.run_experiment()` ì‹œê·¸ë‹ˆì²˜ ìˆ˜ì •

### v1.3.5 (2025-10-30)
- ìºì‹œ ë¬´ê²°ì„± ê²€ì¦ ê°•í™”
- ì¦ë¶„ ë¶„ì„ (incremental) ë„ì…
- DVC ì²´í¬ì•„ì›ƒ ê°œì„ 

---

**ì—…ê·¸ë ˆì´ë“œ ë°©ë²•**:
```bash
cd /path/to/ddoc
git pull
pip install -e .[yolo]
```

**ë¬¸ì˜**: feynmanc@naver.com

